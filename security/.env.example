# KGV Migration Security Configuration Example
# Copy this to .env and update with your secure values
# NEVER commit .env file to version control

# Database Credentials - Use strong passwords (min 20 chars, mixed case, numbers, symbols)
DB_PASSWORD=${DB_PASSWORD}
DB_SSL_MODE=require
DB_SSL_CERT=/certs/postgres/server.crt
DB_SSL_KEY=/certs/postgres/server.key
DB_SSL_CA=/certs/postgres/ca.crt

# Redis Security
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_SSL=true
REDIS_SSL_CERT=/certs/redis/client.crt
REDIS_SSL_KEY=/certs/redis/client.key
REDIS_SSL_CA=/certs/redis/ca.crt

# JWT Security - Use cryptographically secure random tokens
JWT_SECRET=${JWT_SECRET}
JWT_ALGORITHM=RS256
JWT_PUBLIC_KEY=/certs/jwt/public.pem
JWT_PRIVATE_KEY=/certs/jwt/private.pem
JWT_EXPIRY=900  # 15 minutes
JWT_REFRESH_EXPIRY=86400  # 24 hours

# NextAuth Security
NEXTAUTH_SECRET=${NEXTAUTH_SECRET}
NEXTAUTH_URL=https://your-domain.com
NEXTAUTH_SECURE_COOKIES=true

# Admin Passwords - Change these immediately
PGADMIN_PASSWORD=${PGADMIN_PASSWORD}
SEQ_PASSWORD=${SEQ_PASSWORD}
GRAFANA_PASSWORD=${GRAFANA_PASSWORD}

# Encryption Keys for Data at Rest
DATA_ENCRYPTION_KEY=${DATA_ENCRYPTION_KEY}
DATA_ENCRYPTION_ALGORITHM=AES-256-GCM

# Security Headers
CSP_POLICY="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:"
HSTS_MAX_AGE=31536000

# Rate Limiting
RATE_LIMIT_WINDOW=900000  # 15 minutes in ms
RATE_LIMIT_MAX_REQUESTS=100

# Security Monitoring
SECURITY_LOG_LEVEL=INFO
AUDIT_LOG_ENABLED=true
INTRUSION_DETECTION_ENABLED=true

# Network Security
ALLOWED_ORIGINS=https://your-domain.com
TRUSTED_PROXIES=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# GDPR Compliance
GDPR_DATA_RETENTION_DAYS=2555  # 7 years as per German law
GDPR_ANONYMIZATION_ENABLED=true
GDPR_AUDIT_TRAIL_ENABLED=true