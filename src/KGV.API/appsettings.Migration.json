{
  "StranglerFig": {
    "Enabled": true,
    "LegacySystemUrl": "http://legacy-kgv.frankfurt.local",
    "Routes": [
      {
        "Pattern": "^/api/antraege/search.*",
        "MigrationPercentage": 100,
        "Methods": ["GET"],
        "EnableDualWrite": false,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Search endpoints fully migrated",
          "MigratedDate": "2024-02-01"
        }
      },
      {
        "Pattern": "^/api/antraege/[0-9]+$",
        "MigrationPercentage": 75,
        "Methods": ["GET"],
        "EnableDualWrite": false,
        "EnableShadowMode": true,
        "Metadata": {
          "Description": "Individual Antrag retrieval - 75% on new system with shadow validation"
        }
      },
      {
        "Pattern": "^/api/antraege$",
        "MigrationPercentage": 50,
        "Methods": ["POST"],
        "EnableDualWrite": true,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Create Antrag - dual write for data consistency"
        }
      },
      {
        "Pattern": "^/api/antraege/[0-9]+$",
        "MigrationPercentage": 25,
        "Methods": ["PUT", "PATCH"],
        "EnableDualWrite": true,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Update Antrag - cautious migration with dual write"
        }
      },
      {
        "Pattern": "^/api/personen.*",
        "MigrationPercentage": 0,
        "Methods": ["GET", "POST", "PUT", "DELETE"],
        "EnableDualWrite": false,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Personen endpoints still on legacy"
        }
      },
      {
        "Pattern": "^/api/reports.*",
        "MigrationPercentage": 100,
        "Methods": ["GET"],
        "EnableDualWrite": false,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Reports fully migrated with materialized views"
        }
      },
      {
        "Pattern": "^/api/bezirke.*",
        "MigrationPercentage": 90,
        "Methods": ["GET"],
        "EnableDualWrite": false,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "District data mostly migrated"
        }
      },
      {
        "Pattern": "^/api/export.*",
        "MigrationPercentage": 100,
        "Methods": ["GET", "POST"],
        "EnableDualWrite": false,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Export functionality on new system"
        }
      },
      {
        "Pattern": "^/api/auth.*",
        "MigrationPercentage": 100,
        "Methods": ["GET", "POST"],
        "EnableDualWrite": false,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Authentication via Azure AD"
        }
      },
      {
        "Pattern": "^/api/legacy/.*",
        "MigrationPercentage": 0,
        "Methods": ["GET", "POST", "PUT", "DELETE"],
        "EnableDualWrite": false,
        "EnableShadowMode": false,
        "Metadata": {
          "Description": "Explicit legacy endpoints for compatibility"
        }
      }
    ],
    "MigrationSchedule": {
      "Week1-4": {
        "Description": "Foundation Phase",
        "TargetPercentage": 10,
        "Focus": ["Read-only endpoints", "Authentication"]
      },
      "Week5-8": {
        "Description": "Core Migration",
        "TargetPercentage": 30,
        "Focus": ["Search functionality", "Basic CRUD"]
      },
      "Week9-12": {
        "Description": "Data Migration",
        "TargetPercentage": 50,
        "Focus": ["Dual-write for consistency", "Shadow validation"]
      },
      "Week13-16": {
        "Description": "Advanced Features",
        "TargetPercentage": 70,
        "Focus": ["Reports", "Complex workflows"]
      },
      "Week17-20": {
        "Description": "Optimization",
        "TargetPercentage": 85,
        "Focus": ["Performance tuning", "Cache optimization"]
      },
      "Week21-24": {
        "Description": "Final Migration",
        "TargetPercentage": 95,
        "Focus": ["Edge cases", "Legacy compatibility"]
      },
      "Week25-26": {
        "Description": "Cutover",
        "TargetPercentage": 100,
        "Focus": ["Complete migration", "Legacy decommission"]
      }
    }
  },
  "CircuitBreaker": {
    "LegacySystem": {
      "FailureThreshold": 5,
      "DurationOfBreak": 60,
      "MinimumThroughput": 10,
      "SamplingDuration": 30
    },
    "ExternalAPIs": {
      "FailureThreshold": 3,
      "DurationOfBreak": 30,
      "MinimumThroughput": 5,
      "SamplingDuration": 20
    },
    "Database": {
      "FailureThreshold": 3,
      "DurationOfBreak": 30,
      "RetryCount": 3,
      "RetryDelay": 1000
    }
  },
  "Caching": {
    "Redis": {
      "ConnectionString": "redis-cache.frankfurt.azure:6380,ssl=true,password=${REDIS_PASSWORD}",
      "DefaultTTL": 900,
      "Strategies": {
        "Antraege": {
          "TTL": 1800,
          "Pattern": "antrag:*"
        },
        "Personen": {
          "TTL": 3600,
          "Pattern": "person:*"
        },
        "Reports": {
          "TTL": 300,
          "Pattern": "report:*"
        },
        "Static": {
          "TTL": 86400,
          "Pattern": "static:*"
        }
      }
    }
  },
  "Monitoring": {
    "ApplicationInsights": {
      "InstrumentationKey": "${APP_INSIGHTS_KEY}",
      "EnableAdaptiveSampling": true,
      "MaxTelemetryItemsPerSecond": 5
    },
    "HealthChecks": {
      "Database": {
        "Enabled": true,
        "Interval": 30,
        "Timeout": 10
      },
      "Redis": {
        "Enabled": true,
        "Interval": 30,
        "Timeout": 5
      },
      "LegacySystem": {
        "Enabled": true,
        "Interval": 60,
        "Timeout": 15
      }
    }
  }
}